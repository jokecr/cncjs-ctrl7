<!--[if IE]><![endif]-->
<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js ie7 lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js ie8 lt-ie9"> <![endif]-->
<!--[if IE 9]>         <html class="no-js ie9"> <![endif]-->
<!--[if gt IE 9]><!-->
<html class="no-js">
<!--<![endif]-->

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>CTRL7</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="stylesheet" type="text/css" href="vendor/normalize/normalize.css">
  <link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="vendor/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="css/theme.css">
  <link rel="stylesheet" type="text/css" href="css/app.css">
</head>

<body>
  <div id="loading" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
    <div style="background: transparent url('loading.gif') no-repeat 0 0; height: 32px; width: 32px; display: block; margin: 0 auto;"></div>
    <div style="font-family: Arial, Helvetica, sans-serif; font-size: 13px; font-weight: normal; color: #222; text-align: center; margin-top: 10px;">Loading...</div>
  </div>
  <div class="hidden" data-route="workspace">
    <div class="form-group clearfix">
      <div class="pull-left">
        <input type="text" class="form-control" data-name="port" readonly value="" />
      </div>
      <div class="btn-group pull-right">
        <button type="button" class="btn btn-danger" data-name="btn-close"><i class="fa fa-power-off"></i>&nbsp;Close</button>
      </div>
    </div>
    <div class="form-group">
      <ul class="list-group">
        <a href="#/axes" class="list-group-item">Axes</a>
      </ul>
    </div>
    <div class="form-group actions">
    </div>
  </div>
  <div class="hidden" data-route="connection">
    <div data-name="msg"></div>
    <div class="form-group">
      <label>Controller Type</label>
      <select class="form-control" data-name="controllerType">
        <option value="Grbl">Grbl</option>
        <option value="Smoothie">Smoothie</option>
        <option value="TinyG">TinyG</option>
        <option value="Marlin">Marlin</option>
      </select>
    </div>
    <div class="form-group">
      <label>Port</label>
      <select class="form-control" data-name="port"></select>
    </div>
    <div class="form-group">
      <label>Baud rate</label>
      <select class="form-control" data-name="baudrate">
        <option value="250000">250000</option>
        <option value="115200" selected>115200</option>
        <option value="57600">57600</option>
        <option value="38400">38400</option>
        <option value="19200">19200</option>
        <option value="9600">9600</option>
        <option value="4800">4800</option>
        <option value="2400">2400</option>
      </select>
    </div>
    <div class="form-group" style="margin-bottom: 0 ">
      <button type="button" class="btn btn-primary" data-name="btn-open">Open</button>
    </div>
  </div>

  <div class="hidden" data-route="axes">
    <div class="axis-position-row">
      <div class="col-xs-2 ProgramColumn">
        <button type="button" class="btn btn-default" title="Load" onclick="cnc.controller.command('watchdir:load', '1001.nc')">
          1001
        </button>
        <button type="button" class="btn btn-default" title="Load" onclick="cnc.controller.command('watchdir:load', '1002.nc')">
          1002
        </button>
        <button type="button" class="btn btn-default" title="Load" onclick="cnc.controller.command('watchdir:load', '1003.nc')">
          1003
        </button>
        <button type="button" class="btn btn-default" title="Load" onclick="cnc.controller.command('watchdir:load', '100.nc')">
          1004
        </button>
        <button type="button" class="btn btn-default" title="Load" onclick="cnc.controller.command('watchdir:load', '1005.nc')">
          1005
        </button>
        <button type="button" class="btn btn-default" title="Load" onclick="cnc.controller.command('watchdir:load', '1006.nc')">
          1006
        </button>
      </div>

      <div class="col-xs-10 control-pad">
        <div class="row no-gutter AbsPos">
          <div class="col-xs-4">
            <div class="axis-position x-axis" data-name="mpos-x">0.000</div>
          </div>
          <div class="col-xs-4">
            <div class="axis-position y-axis" data-name="mpos-y">0.000</div>
          </div>
          <div class="col-xs-4">
            <div class="axis-position z-axis" data-name="mpos-z">0.000</div>
          </div>
        </div>
        <div class="row no-gutter RelPos">
          <div class="col-xs-1">
            <button type="button" class="btn btn-zero x-axis" title="G10 L20 P1 X0" onclick="cnc.controller.command('gcode', 'G10 L20 X0')">
              0
            </button>
          </div>
          <div class="col-xs-3">
            <div class="axis-position x-axis" data-name="wpos-x">0.000</div>
          </div>
          <div class="col-xs-1">
            <button type="button" class="btn btn-zero y-axis" title="G10 L20 P1 Y0" onclick="cnc.controller.command('gcode', 'G10 L20 Y0')">
              0
            </button>
          </div>
          <div class="col-xs-3">
            <div class="axis-position y-axis" data-name="wpos-y">0.000</div>
          </div>
          <div class="col-xs-1">
            <button type="button" class="btn btn-zero z-axis" title="G10 L20 P1 Z0" onclick="cnc.controller.command('gcode', 'G10 L20 Z0')">
              0
            </button>
          </div>
          <div class="col-xs-3">
            <div class="axis-position z-axis" data-name="wpos-z">0.000</div>
          </div>
        </div>
        <div class="col-xs-2 Presets">
          <button type="button" class="btn jog btn-default" title="Fullscreen" onclick="toggleFullScreen()">
            FS
          </button>
          <button type="button" class="btn jog btn-default" title="Init" onclick="cnc.bitSetter('Init');">
            BSI
          </button>
          <button type="button" class="btn jog btn-default" title="ToolChange" onclick="cnc.bitSetter('ToolChange');">
            TC
          </button>
          <button type="button" class="btn jog btn-default" title="ToolChange Init" onclick="cnc.bitSetter('ToolChangeInit');">
            TCI
          </button>
        </div>
        <div class="col-xs-2 Presets">
          <button type="button" class="btn jog btn-default jog-x-zero x-axis" title="Move To X Zero (G0 X0)" onclick="cnc.sendMove('X0')">
            X0
          </button>

          <button type="button" class="btn jog btn-default jog-y-zero y-axis" title="Move To Y Zero (G0 Y0)" onclick="cnc.sendMove('Y0')">
            Y0
          </button>
          <button type="button" class="btn jog btn-default jog-z-zero z-axis" title="Move To Z Zero (G0 Z0)" onclick="cnc.sendMove('Z0')">
            Z0
          </button>
          <button type="button" class="btn jog btn-default z-axis" title="Move Z Safe" onclick="cnc.controller.command('gcode', 'G53 G0 z-10')">
            Up
          </button>

        </div>

        <div class="col-xs-2 Params">
          <button type="button" data-name="step0025" class="btn jog btn-default" onclick="cnc.setStep(0.025)">
            0.025
          </button>
          <button type="button" data-name="step0100" class="btn jog btn-default" onclick="cnc.setStep(0.100)">
            0.100
          </button>
          <button type="button" data-name="step1000" class="btn jog btn-default" onclick="cnc.setStep(1.000)">
            1.000
          </button>
          <button type="button" data-name="step10000" class="btn jog btn-default" onclick="cnc.setStep(10.000)">
            10.000
          </button>
        </div>

        <div class="col-xs-5 JogPad">
          <div class="row no-gutter">
            <div class="col-xs-3">
            </div>
            <div class="col-xs-3">
              <button type="button" class="btn jog btn-default jog-y-plus y-axis" title="Move Y+" onclick="cnc.sendMove('Y+')">
                Y+
              </button>
            </div>
            <div class="col-xs-3">
            </div>
            <div class="col-xs-3">
              <button type="button" class="btn jog btn-default jog-z-plus z-axis" title="Move Z+" onclick="cnc.sendMove('Z+')">
                Z+
              </button>
            </div>
          </div>
          <div class="row no-gutter">
            <div class="col-xs-3">
              <button type="button" class="btn jog btn-default jog-x-minus x-axis" title="Move X-" onclick="cnc.sendMove('X-')">
                X-
              </button>
            </div>

            <div class="col-xs-3">
            </div>
            <div class="col-xs-3">
              <button type="button" class="btn jog btn-default jog-x-plus x-axis" title="Move X+" onclick="cnc.sendMove('X+')">
                X+
              </button>
            </div>
            <div class="col-xs-3">
            </div>
          </div>
          <div class="row no-gutter">
            <div class="col-xs-3">
            </div>

            <div class="col-xs-3">
              <button type="button" class="btn jog btn-default jog-y-minus y-axis" title="Move Y-" onclick="cnc.sendMove('Y-')">
                Y-
              </button>
            </div>



            <div class="col-xs-3">
            </div>
            <div class="col-xs-3">
              <button type="button" class="btn jog btn-default jog-z-minus z-axis" title="Move Z-" onclick="cnc.sendMove('Z-')">
                Z-
              </button>
            </div>

          </div>
        </div>
      </div>
      <div class="nav-panel">
        <div class="container-fluid">
          <div class="row no-gutter">
            <div class="col-xs-3">
              <div class="active-state" data-name="active-state"></div>
            </div>
            <div class="col-xs-9">
              <div class="gcode" data-name="gcode">gcode</div>
            </div>
          </div>
        </div>
      </div>
      <div id="container">
      	<video autoplay="true" id="videoElement">

      	</video>
      </div>
    </div>

  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script src="vendor/director/director.min.js"></script>
  <script src="vendor/lodash/lodash.min.js"></script>
  <script src="vendor/jquery/jquery-2.2.1.min.js"></script>
  <script src="vendor/async/async.min.js"></script>
  <script src="vendor/iframe-resizer/iframeResizer.contentWindow.min.js"></script>
  <script src="vendor/js-cookie/js.cookie.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.min.js"></script>
  <script>
    $('document').ready(function() {
      var root = window;
      root.cnc = {
        router: null,
        controller: null,
        controllerType: Cookies.get('cnc.controllerType'),
        port: Cookies.get('cnc.port'),
        baudrate: Cookies.get('cnc.baudrate'),
        connected: false
      };
      root.cnc.router = window.Router({
        '/': function() {
          if (root.cnc.connected) {
            window.location = '#/workspace';
          } else {
            window.location = '#/connection';
          }
        },
        '/workspace': function() {},
        '/connection': function() {},
        '/axes': function() {}
      });
      root.cnc.router.configure({
        on: function() {
          var route = window.location.hash.slice(2);
          var views = $('[data-route]');
          var view = views.filter('[data-route="' + route + '"]');

          if (view.length) {
            views.addClass('hidden');
            view.removeClass('hidden');
          }
        }
      });
    });
  </script>
  <script src="controller.js"></script>
  <script src="app.js"></script>
</body>

</html>
